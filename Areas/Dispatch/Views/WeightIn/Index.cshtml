@model ResponseModel<WeightIn>

@{
	ViewData["Title"] = "Weighment In";
}
<!-- Content Header (Page header) -->
<section class="content-header bg-gradient-green" style="border-radius: 0.25rem">
	<div class="container-fluid">
		<div class="row mb-2">
			<div class="col-sm-12">
				<h1 class="font-weight-bold">Weighment In</h1>
			</div>
		</div>
	</div>
</section>

<!-- Main content -->
<section class="content p-0">
	<div class="container-fluid p-0">
		<div class="row no-gutters">
			<div class="col-12 card">
				<form id="formSave" asp-controller="WeightIn" asp-action="Save" method="post" class="form-horizontal" enctype="multipart/form-data" data_form_isvalidate>
					<div class="card-body pb-0">
						<div class="panel-divider">
							<span>Search Details</span>
							<div class="row no-gutters p-0 m-0">
								<div class="col-10 card card-primary p-0 m-0 shadow-none" style="margin: 0rem !important;">
									<div class="form-horizontal">
										<div class="card-body py-1 px-0">
											<div class="form-group row">
												<label for="Inward_Sys_Id" class="col-sm-2 col-form-label">Inward Type <span class="text-danger">*</span></label>
												<div class="col-sm-4">
													<select id="Inward_Sys_Id" name="Inward_Sys_Id" class="form-control form-control-sm select2" style="width: 100%;"
															onchange="fnChange_Select(this, null)" data-required data-msg="The Inward Type field is required.">
														@if (Model != null && Model.SelectListItems.Where(x => x.Group == "INWARDTYPE") != null)
														{
															foreach (var item in Model.SelectListItems.Where(x => x.Group == "INWARDTYPE" && (x.Value == "1" || x.Value == "4")).OrderBy(x => x.OrderBy).ToList())
															{
																if (item.Value == "1")
																{
																	<option value="@item.Value" data-type="" selected>@item.Text</option>
																}
																else
																{
																	<option value="@item.Value" data-type="">@item.Text</option>
																}
															}
														}
													</select>
												</div>
											</div>
											<div class="form-group row">
												<div class="col-6">
													<div class="input-group input-group-sm ">
														<label class="col-sm-4 col-form-label pl-0">Vehicle Number / MDA Number </label>
														<span class="input-group-append col-sm-8 ml-0">
															<input type="text" class="form-control form-control-sm" id="inputSearch" autocomplete="off">
														</span>
													</div>
												</div>
												<div class="col-6">
													<span class="input-group-append ml-0">
														<button type="button" class="btn btn-info btn-flat mr-2" onclick="GetMDA(this, 'S')">Search</button>
														<button type="button" class="btn btn-info btn-flat b-radius-0" onclick="GetMDA(this, 'V')">View Vehicle</button>
													</span>
												</div>
											</div>
										</div>
									</div>
								</div>
							</div>
						</div>

						<div class="panel-divider">
							<span>Vehicle Details</span>
							<div class="row no-gutters p-0 m-0">
								<div class="col-10 card card-primary p-0 m-0 shadow-none" style="margin: 0rem !important;">
									<div class="form-horizontal">
										<div class="card-body py-1 px-0">
											<div class="form-group row">
												<div class="col-6">
													<div class="input-group input-group-sm ">
														<label for="Truck_No" class="col-sm-4 col-form-label pl-0">Vehicle Number </label>
														<div class="col-sm-6">
															<input type="text" class="form-control form-control-sm" id="Truck_No" name="Truck_No" data-required data-msg="Vehicle Number is required." autocomplete="off" readonly>
															<input type="text" class="form-control form-control-sm d-none" id="Id" name="Gate_In_Id">
														</div>
													</div>
												</div>
												<div class="col-6">
													<div class="input-group input-group-sm ">
														<label for="MDA_No" class="col-sm-4 col-form-label" id="labelMDANo">MDA Number </label>
														<div class="col-sm-6">
															<input type="text" class="form-control form-control-sm" id="MDA_No" name="MDA_No" autocomplete="off" readonly>
														</div>
													</div>
												</div>
											</div>
											<div class="form-group row">
												<label for="Transporter_Name" class="col-sm-2 col-form-label" id="labelTransporter">Transporter Name  </label>
												<div class="col-sm-9">
													<input type="text" class="form-control form-control-sm" id="Transporter_Name" name="Transporter_Name" autocomplete="off" readonly>
												</div>
											</div>
											<div class="form-group row">
												<div class="col-6">
													<div class="input-group input-group-sm ">
														<label for="Driver_Name" class="col-sm-4 col-form-label pl-0">Driver Name </label>
														<span class="input-group-append col-sm-6 ml-0">
															<input type="text" class="form-control form-control-sm" id="Driver_Name" name="Driver_Name" autocomplete="off" readonly>
														</span>
													</div>
												</div>
												<div class="col-6">
													<div class="input-group input-group-sm ">
														<label for="Driver_Contact" class="col-sm-4 col-form-label pl-0">Driver Contact </label>
														<span class="input-group-append col-sm-6 ml-0">
															<input type="text" class="form-control form-control-sm isNumberKey" id="Driver_Contact" name="Driver_Contact" autocomplete="off" readonly>
														</span>
													</div>
												</div>
											</div>
											<div class="form-group row">
												<div class="col-6">
													<div class="input-group input-group-sm ">
														<label for="Driver_Id_Proof_Type" class="col-sm-4 col-form-label pl-0">Driver Id Proof Type </label>
														<span class="input-group-append col-sm-6 ml-0">
															<input type="text" class="form-control form-control-sm" id="Driver_Id_Proof_Type" autocomplete="off" readonly>
														</span>
													</div>
												</div>
												<div class="col-6">
													<div class="input-group input-group-sm ">
														<label for="Driver_Id_Number" class="col-sm-4 col-form-label pl-0">Driver Id Number </label>
														<span class="input-group-append col-sm-6 ml-0">
															<input type="text" class="form-control form-control-sm isNumberKey" id="Driver_Id_Number" autocomplete="off" readonly>
														</span>
													</div>
												</div>
											</div>
											<div class="form-group row divOthers d-none">
												<div class="col-6">
													<div class="input-group input-group-sm ">
														<label for="Driver_Id_Proof_Type" class="col-sm-4 col-form-label pl-0">Transaction Type </label>
														<span class="input-group-append col-sm-6 ml-0">
															<input type="text" class="form-control form-control-sm" id="TransactionType" autocomplete="off" readonly>
														</span>
													</div>
												</div>
											</div>
										</div>
									</div>
								</div>
							</div>
						</div>

						<div class="panel-divider">
							<span>Weighment Details</span>
							<div class="row no-gutters p-0 m-0">
								<div class="col-10 card card-primary p-0 m-0 shadow-none" style="margin: 0rem !important;">
									<div class="form-horizontal">
										<div class="card-body py-1 px-0">
											<div class="form-group row divOthers d-none">
												<label for="WeighIn_Wt" class="col-sm-2 col-form-label">Weigh In Weight <span class="text-danger">*</span></label>
												<div class="col-sm-4">
													<input type="text" class="form-control form-control-sm isNumberKey_Decimal" id="WeighIn_Wt" name="WeighIn_Wt" autocomplete="off">
												</div>
												<div class="col-sm-5">
													<span class="input-group-append ml-0">
														<button type="button" class="btn btn-info btn-flat mr-2" onclick="fnRead_Weight('#WeighIn_Wt')">Capture</button>
													</span>
												</div>
											</div>
											<div class="form-group row divOthers_Hide">
												<label for="Tare_Wt" class="col-sm-2 col-form-label">Tare Weight <span class="text-danger">*</span></label>
												<div class="col-sm-4">
													<input type="text" class="form-control form-control-sm isNumberKey_Decimal" id="Tare_Wt" name="Tare_Wt" autocomplete="off">
												</div>
												<div class="col-sm-5">
													<span class="input-group-append ml-0">
														<button type="button" class="btn btn-info btn-flat mr-2" onclick="fnRead_Weight('#Tare_Wt')">Capture</button>
													</span>
												</div>
											</div>
											<div class="form-group row divOthers_Hide">
												<label class="col-sm-2 col-form-label">Weighment DateTime</label>
												<div class="col-sm-4">
													<input type="text" class="form-control form-control-sm" value="@DateTime.Now.ToString("dd/MM/yyyy HH:mm").Replace("-", "/")" autocomplete="off" readonly>
												</div>
												<label for="chkTareWeightManually" class="col-sm-3 col-form-label">Enter Tare Weight Manually?</label>
												<div class="col-sm-3">
													<div class="icheck-primary d-inline">
														<input type="checkbox" id="chkTareWeightManually" name="Is_Tare_Wt_Manually" checked>
														<label for="chkTareWeightManually"> &nbsp; </label>
													</div>
												</div>


											</div>
										</div>
									</div>
								</div>
							</div>
						</div>

						<div class="panel-divider">
							<span>Notes</span>
							<div class="row no-gutters p-0 m-0">
								<div class="col-10 card card-primary p-0 m-0 shadow-none" style="margin: 0rem !important;">
									<div class="form-horizontal">
										<div class="card-body py-1 px-0">
											<div class="form-group row">
												<div class="col-12">
													<div class="input-group input-group-sm ">
														<label for="Notes" class="col-sm-2 col-form-label pl-0">Notes</label>
														<span class="input-group-append col-sm-9 ml-0">
															<input type="text" class="form-control form-control-sm" id="Notes" name="Tare_Wt_Note">
														</span>
													</div>
												</div>
											</div>
											<div class="form-group row">
												<label for="Verified_Documents" class="col-sm-3 col-form-label">Verified Documents?</label>
												<div class="col-sm-3">
													<div class="icheck-primary d-inline">
														<input type="checkbox" id="Verified_Documents" name="Verified_Documents">
														<label for="Verified_Documents"> &nbsp; </label>
													</div>
												</div>
												<label for="Verified_Officer" class="col-sm-2 col-form-label">Verified Officer Name</label>
												<div class="col-sm-3">
													<input type="text" class="form-control form-control-sm" id="Verified_Officer" name="Verified_Officer" autocomplete="off" readonly>
													<input type="text" class="form-control form-control-sm d-none" id="Verified_Officer_Id" name="Verified_Officer_Id" autocomplete="off" readonly>
												</div>
											</div>
										</div>
									</div>
								</div>
							</div>
						</div>
					</div>
					<div class="card-footer">
						<button type="button" class="btn btn-info btn-flat px-3 mr-3 btnSubmit">Save</button>
						<button type="button" class="btn btn-danger btn-flat px-3 mr-3" onclick="fnClearFormData('#formSave')">Clear</button>
						<button type="button" class="btn btn-danger btn-flat px-3 mr-3">Close</button>
						<span class="float-right mr-3"><span class="text-danger">*</span> Mandatory Fields</span>
					</div>
				</form>
			</div>
		</div>
	</div>
</section>

@section Scripts {
	<script type="text/javascript">
		var table = {};

		var currentUser = '@Common.Get_Session(SessionKey.USER_NAME)';

		$(document).ready(function () {

			$('#fileReadWeight').change(function () {
				debugger
				$('#Tare_Wt').val('');
				$('#Tare_Wt').trigger('change');

				var files = $(this).prop('files');
				var fileList = $('#fileList');
				fileList.empty();

				if (files.length > 0) {
					var file = files[0];
					var expectedPath = 'D:\SAP1/demo.txt';
					var fullPath = file.webkitRelativePath || file.name;

					if (file.name.endsWith('.txt') && fullPath.includes(expectedPath)) {
						fileList.append('<li>' + file.name + '</li>');
					} else {
						fileList.append('<li>Selected file is not the expected .txt file. Please select the correct .txt file.</li>');
					}
				} else {
					fileList.append('<li>No file selected.</li>');
				}

				if (file.type !== 'text/plain') {
					CommonAlert_Error('Please upload a valid text file.');
					return;
				}

				const maxSize = 1 * 1024 * 1024;
				if (file.size > maxSize) {
					CommonAlert_Error('File size exceeds 1MB.');
					return;
				}

				const reader = new FileReader();
				reader.onload = function (event) {
					const content = event.target.result;
					$('#Tare_Wt').val(content);
					$('#Tare_Wt').trigger('change');
				};

				reader.onerror = function () {
					CommonAlert_Error('Error reading file.');
				};

				reader.readAsText(file);
			});

			$('input#MDA').prop('checked', true);
			$('input#MDA').trigger('change');
			$('input#Verified_Officer_Id').val('@Common.Get_Session(SessionKey.USER_ID)');
			$('input#Verified_Officer_Id').trigger('change');
			$('input#Verified_Officer').val('@Common.Get_Session(SessionKey.USER_NAME)');
			$('input#Verified_Officer').trigger('change');

			$('#chkTareWeightManually').change(function () {
				if ($(this).is(':checked')) {
					$('#Tare_Wt').removeAttr('readonly');
				} else {
					$('#Tare_Wt').attr('readonly', 'readonly');
				}
			});

		});


		function fnChange_Select($this, $selecter) {

			fnClear_MDA();

		}


		function GetMDA($this, $type) {
			ShowLoader(true);

			if ($('#modal-xl').hasClass('show')) $('#modal-xl').hide();

			$.ajax({
				type: "GET",
				url: '@Url.Action("GetMDA", "WeightIn")?type=' + $type + '&searchTerm=' + $('#inputSearch').val() + '&Inward_Sys_Id=' + $('#Inward_Sys_Id option:selected').val(),
				data: null,
				contentType: "application/json; charset=utf-8",
				dataType: "html",
				success: function (response) {

					fnClear_MDA();

					if (typeof response == 'undefined' || response == null || response == 'null' || response.length <= 0) {
						CommonAlert_Error("No any record(s) found");
						return false;
					}

					if (response.indexOf('{') == 0) {

						setTimeout(function () {

							try {

								if (typeof response != 'undefined' && response != null && response.length > 0) {

									var selectedData = JSON.parse(response);

									$('#Id').val(selectedData['id']);
									$('#Inward_Sys_Id').val(selectedData['inward_Sys_Id']);
									$('#Truck_No').val(selectedData['truck_No']);
									$('#MDA_No').val(selectedData['mdA_No']);
									$('#Transporter_Name').val(selectedData['transporter_Name']);
									$('#Driver_Name').val(selectedData['driver_Name']);
									$('#Driver_Contact').val(selectedData['driver_Contact']);
									$('#Driver_Id_Proof_Type').val(selectedData['driver_Id_Type']);
									$('#Driver_Id_Number').val(selectedData['driver_Id_Number']);

									$('#Verified_Documents').prop('checked', (typeof (selectedData['verified_Documents']) != 'undefined' && (selectedData['verified_Documents']) != null && (selectedData['verified_Documents']) == 'True' ? true : false));

									$('#Id').trigger('change');
									$('#Truck_No').trigger('change');
									$('#MDA_No').trigger('change');
									$('#Transporter_Name').trigger('change');
									$('#Driver_Name').trigger('change');
									$('#Driver_Contact').trigger('change');
									$('#Driver_Id_Proof_Type').trigger('change');
									$('#Driver_Id_Number').trigger('change');

									$('input#Verified_Officer_Id').val('@Common.Get_Session(SessionKey.USER_ID)');
									$('input#Verified_Officer_Id').trigger('change');
									$('input#Verified_Officer').val('@Common.Get_Session(SessionKey.USER_NAME)');
									$('input#Verified_Officer').trigger('change');

									var Inward_Sys_Id = $('#Inward_Sys_Id option:selected').val();

									if (typeof Inward_Sys_Id != 'undefined' && Inward_Sys_Id != null && Inward_Sys_Id == 1) {

										$('#labelMDANo').html('MDA Number');
										$('#labelTransporter').html('Transporter Name');

										$('.divOthers').addClass('d-none');
										$('.divOthers input').val('').trigger('change');

										$('.divOthers_Hide').removeClass('d-none');
										$('.divOthers_Hide input').val('').trigger('change');

									} else if (typeof Inward_Sys_Id != 'undefined' && Inward_Sys_Id != null && Inward_Sys_Id == 4) {

										$('#labelMDANo').html('Order Number');
										$('#labelTransporter').html('Party/Supplier');

										$('.divOthers').removeClass('d-none');
										$('.divOthers input').val('').trigger('change');

										$('.divOthers_Hide').addClass('d-none');
										$('.divOthers_Hide input').val('').trigger('change');

										$('.divOthers #TransactionType').val(selectedData['transactionType']).trigger('change');
									}

								} else
									CommonAlert_Error("No any record(s) found");

							} catch { }

							ShowLoader(false);

						}, 1000);

					}
					else {

						$('#modal-xl .modal-body').html('');
						$('#modal-xl .modal-body').append(response);

						var Inward_Sys_Id = $('#Inward_Sys_Id option:selected').val();

						if (typeof Inward_Sys_Id != 'undefined' && Inward_Sys_Id != null && Inward_Sys_Id == 1) {

							if ($type == 'S')
								$('#modal-xl .modal-title').html('Search MDA');
							else
								$('#modal-xl .modal-title').html('View MDA');

						}
						else if (typeof Inward_Sys_Id != 'undefined' && Inward_Sys_Id != null && Inward_Sys_Id == 4) {

							if ($type == 'S')
								$('#modal-xl .modal-title').html('Search Other Material');
							else
								$('#modal-xl .modal-title').html('View Other Material');

						}

						setTimeout(function () {

							try {

								if ($.fn.DataTable.isDataTable('#modal-xl .modal-body #table_Common')) {
									$('#modal-xl .modal-body #table_Common').DataTable().destroy();
								}

								var indexLastCol = $('#modal-xl .modal-body #table_Common tbody tr:eq(0) td').length - 1;

								table = $('#modal-xl .modal-body #table_Common').DataTable({
									paging: true,
									lengthChange: true,
									searching: true,
									ordering: true,
									info: true,
									autoWidth: true,
									responsive: true,
									order: [[indexLastCol, 'asc']],
									pageLength: 10,
									lengthMenu: [
										[10, 25, 50, -1],
										[10, 25, 50, 'All']
									],
									fixedColumns: true,
									dom: "<'row'<'col-sm-12 col-md-6'l><'col-sm-12 col-md-6'f>>" +
										"<'row'<'col-sm-12'tr>>" +
										"<'row'<'col-sm-12 col-md-5'i><'col-sm-12 col-md-7'p>>"
								});

								$('#modal-xl .modal-body #table_Common').css('width', '100%');

								table.on('click', 'tbody tr', function (e) {

									$(e.currentTarget.parentElement).find('tr').each(function (i, ez) {
										if (i != (e.currentTarget.rowIndex - 1))
											$(ez).removeClass('bg-info');
									});

									if (e.currentTarget.classList.contains('bg-info')) {

										$('#Id').val('');
										//$('#Inward_Sys_Id').val('');
										$('#Truck_No').val('');
										$('#MDA_No').val('');
										$('#Transporter_Name').val('');
										$('#Driver_Name').val('');
										$('#Driver_Contact').val('');
										$('#Driver_Id_Proof_Type').val('');
										$('#Driver_Id_Number').val('');
										$('#Verified_Documents').prop('checked', false);

										$('input#Verified_Officer_Id').val('@Common.Get_Session(SessionKey.USER_ID)');
										$('input#Verified_Officer_Id').trigger('change');
										$('input#Verified_Officer').val('@Common.Get_Session(SessionKey.USER_NAME)');
										$('input#Verified_Officer').trigger('change');
									}

									e.currentTarget.classList.toggle('bg-info');

									var selectedData = table.rows('.bg-info').data();

									debugger;

									var Inward_Sys_Id = $('#Inward_Sys_Id option:selected').val();

									if (typeof Inward_Sys_Id != 'undefined' && Inward_Sys_Id != null && Inward_Sys_Id == 1) {

										$('#labelMDANo').html('MDA Number');
										$('#labelTransporter').html('Transporter Name');

										$('.divOthers').addClass('d-none');
										$('.divOthers input').val('').trigger('change');

										$('.divOthers_Hide').removeClass('d-none');
										$('.divOthers_Hide input').val('').trigger('change');

									} else if (typeof Inward_Sys_Id != 'undefined' && Inward_Sys_Id != null && Inward_Sys_Id == 4) {

										$('#labelMDANo').html('Order Number');
										$('#labelTransporter').html('Party/Supplier');

										$('.divOthers').removeClass('d-none');
										$('.divOthers input').val('').trigger('change');

										$('.divOthers_Hide').addClass('d-none');
										$('.divOthers_Hide input').val('').trigger('change');

									}

									if (typeof selectedData != 'undefined' && selectedData != null && selectedData.length >= 1) {

										if (typeof Inward_Sys_Id != 'undefined' && Inward_Sys_Id != null && Inward_Sys_Id == 1) {

											$('#Id').val(selectedData[0][7]);
											$('#Truck_No').val(selectedData[0][0]);
											$('#MDA_No').val(selectedData[0][1]);
											$('#Transporter_Name').val(selectedData[0][5]);
											$('#Driver_Name').val(selectedData[0][3]);
											$('#Driver_Contact').val(selectedData[0][4]);
											$('#Driver_Id_Proof_Type').val(selectedData[0][12]);
											$('#Driver_Id_Number').val(selectedData[0][13]);

											$('#Verified_Documents').prop('checked', (typeof (selectedData[0][11]) != 'undefined' && (selectedData[0][11]) != null && (selectedData[0][11]) == 'True' ? true : false));

										}
										else if (typeof Inward_Sys_Id != 'undefined' && Inward_Sys_Id != null && Inward_Sys_Id == 4) {

											$('#Id').val(selectedData[0][8]);
											$('#Truck_No').val(selectedData[0][0]);
											$('#MDA_No').val(selectedData[0][1]);
											$('#Transporter_Name').val(selectedData[0][6]);
											$('#Driver_Name').val(selectedData[0][4]);
											$('#Driver_Contact').val(selectedData[0][5]);
											$('#Driver_Id_Proof_Type').val(selectedData[0][13]);
											$('#Driver_Id_Number').val(selectedData[0][14]);

											$('#Verified_Documents').prop('checked', (typeof (selectedData[0][12]) != 'undefined' && (selectedData[0][12]) != null && (selectedData[0][12]) == 'True' ? true : false));

											$('.divOthers #TransactionType').val(selectedData[0][3]).trigger('change');
										}

									}


									$('#Id').trigger('change');
									//$('#Inward_Sys_Id').trigger('change');
									$('#Truck_No').trigger('change');
									$('#MDA_No').trigger('change');
									$('#Transporter_Name').trigger('change');
									$('#Driver_Name').trigger('change');
									$('#Driver_Contact').trigger('change');
									$('#Verified_Documents').trigger('change');
									$('#Driver_Id_Proof_Type').trigger('change');
									$('#Driver_Id_Number').trigger('change');

									$('input#Verified_Officer_Id').val('@Common.Get_Session(SessionKey.USER_ID)');
									$('input#Verified_Officer_Id').trigger('change');
									$('input#Verified_Officer').val('@Common.Get_Session(SessionKey.USER_NAME)');
									$('input#Verified_Officer').trigger('change');

								});


							} catch { }

							if ($('#modal-xl .modal-body #table_Common tbody tr').length > 0)
								$('#modal-xl').show();
							else
								CommonAlert_Error("No any record(s) found");

							ShowLoader(false);

						}, 1000);
					}
				},
				failure: function (response) { fnClear_MDA(); CommonAlert_Error(null); },
				error: function (response) { fnClear_MDA(); CommonAlert_Error(null); }
			});
		}

		function fnSelect_MDA() {

			if ($('#table_Common tbody tr.bg-info').length <= 0) {
				CommonAlert_Error("Please select one MDA Number");
				return false;
			}
			else {
				fnClose_Modal()
			}
		}

		function fnClear_MDA() {

			$('#table_Common tbody tr.bg-info').each(function (i, ez) {
				$(ez).removeClass('bg-info');
			});

			$('#Id').val('');
			//$('#Inward_Sys_Id').val('');
			$('#Truck_No').val('');
			$('#MDA_No').val('');
			$('#Transporter_Name').val('');
			$('#Driver_Name').val('');
			$('#Driver_Contact').val('');
			$('#Driver_Id_Proof_Type').val('');
			$('#Driver_Id_Number').val('');
			$('#Verified_Documents').prop('checked', false);

			$('#Id').trigger('change');
			//$('#Inward_Sys_Id').trigger('change');
			$('#Truck_No').trigger('change');
			$('#MDA_No').trigger('change');
			$('#Transporter_Name').trigger('change');
			$('#Driver_Name').trigger('change');
			$('#Driver_Contact').trigger('change');
			$('#Verified_Documents').trigger('change');
			$('#Driver_Id_Proof_Type').trigger('change');
			$('#Driver_Id_Number').trigger('change');

			$('input#Verified_Officer_Id').val('@Common.Get_Session(SessionKey.USER_ID)');
			$('input#Verified_Officer_Id').trigger('change');
			$('input#Verified_Officer').val('@Common.Get_Session(SessionKey.USER_NAME)');
			$('input#Verified_Officer').trigger('change');

			var Inward_Sys_Id = $('#Inward_Sys_Id option:selected').val();

			if (typeof Inward_Sys_Id != 'undefined' && Inward_Sys_Id != null && Inward_Sys_Id == 1) {

				$('#labelMDANo').html('MDA Number');
				$('#labelTransporter').html('Transporter Name');

				$('.divOthers').addClass('d-none');
				$('.divOthers input').val('').trigger('change');

				$('.divOthers_Hide').removeClass('d-none');
				$('.divOthers_Hide input').val('').trigger('change');

			} else if (typeof Inward_Sys_Id != 'undefined' && Inward_Sys_Id != null && Inward_Sys_Id == 4) {

				$('#labelMDANo').html('Order Number');
				$('#labelTransporter').html('Party/Supplier');

				$('.divOthers').removeClass('d-none');
				$('.divOthers input').val('').trigger('change');

				$('.divOthers_Hide').addClass('d-none');
				$('.divOthers_Hide input').val('').trigger('change');

			}

		}

		$(document).on("change", 'input[name="Option"]', function (e) {

			$('input.truck_no').val('')
			$('input.truck_no').trigger('change')
			$('.mda_no input').val('')
			$('.mda_no input').trigger('change')

			if (e.target.id == 'MDA') {
				$('input.truck_no').prop('readonly', true);
			} else {
				$('input.truck_no').prop('readonly', false);
			}
		});



		function fnRead_Weight($selector) {

			ShowLoader(true);

			if ($('#modal-xl').hasClass('show')) $('#modal-xl').hide();

			$($selector).val('');
			$($selector).trigger('change');

			debugger;
			var strEntries = '@Convert.ToString(AppHttpContextAccessor.AppConfiguration.GetSection("Weighbridge_Interface_IPs_Ports").Value ?? "")';

			var listWeighbridge = [];
			var entries = strEntries.split(',');

			entries.forEach(function (entry) {
				var parts = entry.trim().split(':');
				if (parts.length === 3 && !isNaN(parseInt(parts[2], 10))) {
					listWeighbridge.push({
						Name: parts[0],
						IP: parts[1],
						Port: parseInt(parts[2], 10)
					});
				}
			});

			debugger;
			if (typeof listWeighbridge != 'undefined' && listWeighbridge != null && listWeighbridge.length > 1) {

				var strHTML = '';

				listWeighbridge.forEach(function (tuple, i) {
					var radioButton = '<label><input type="radio" name="weighbridge" value="' + tuple.IP + ':' + tuple.Port + '" ' + (i == 0 ? "checked" : "") + '>' + tuple.Name + '</label><br>';
					strHTML += radioButton;
				});

				debugger;

				Swal.fire({
					icon: 'warning',
					title: "Select Weighbridge",
					showDenyButton: false,
					showCancelButton: true,
					confirmButtonText: 'Confirm!',
					cancelButtonText: 'Cancel',
					confirmButtonColor: '#3085d6',
					cancelButtonColor: '#d33',
					html: strHTML,
				}).then((result) => {
					debugger;
					if (result != null && result.isConfirmed == true
						&& typeof $('input[name="weighbridge"]:checked').val() != 'undefined'
						&& $('input[name="weighbridge"]:checked').val() != null
						&& $('input[name="weighbridge"]:checked').val().length > 0) {

						$.ajax({
							type: "GET",
							url: '@Url.Action("GetWeighbridge_Interface_Data","WeightIn")?Weighbridge_Id=' + $('input[name="weighbridge"]:checked').val(),
							data: null,
							contentType: "application/json; charset=utf-8",
							dataType: "json",
							success: function (response) {

								setTimeout(function () {

									ShowLoader(false);

									try {
										if (typeof response != 'undefined' && response != '' && response != null
											&& typeof response.statusCode != 'undefined' && response.statusCode != '' && response.statusCode != null && response.statusCode === 1) {
											$($selector).val(response.data1);
											$($selector).trigger('change');
										}
										else {
											CommonAlert_Error(response.message, null)
										}
									} catch { $($selector).val('0'); $($selector).trigger('change'); }

								}, 2000);
							},
							failure: function (response) { ShowLoader(false); $($selector).val('0'); $($selector).trigger('change'); },
							error: function (response) { ShowLoader(false); $($selector).val('0'); $($selector).trigger('change'); }
						});
					}
				});

			}
			else {
				debugger;
				$.ajax({
					type: "GET",
					url: '@Url.Action("GetWeighbridge_Interface_Data","WeightIn")?Weighbridge_Id=',
					data: null,
					contentType: "application/json; charset=utf-8",
					dataType: "json",
					success: function (response) {

						setTimeout(function () {

							ShowLoader(false);

							try {
								if (typeof response != 'undefined' && response != '' && response != null
									&& typeof response.statusCode != 'undefined' && response.statusCode != '' && response.statusCode != null && response.statusCode === 1) {
									$($selector).val(response.data1);
									$($selector).trigger('change');
								}
								else {
									CommonAlert_Error(response.message, null)
								}
							} catch { $($selector).val('0'); $($selector).trigger('change'); }

						}, 2000);
					},
					failure: function (response) { ShowLoader(false); $($selector).val('0'); $($selector).trigger('change'); },
					error: function (response) { ShowLoader(false); $($selector).val('0'); $($selector).trigger('change'); }
				});
			}

		}


	</script>
}
